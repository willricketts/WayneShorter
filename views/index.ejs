<!DOCTYPE html>
<html>
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet">
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <link href='http://fonts.googleapis.com/css?family=Sacramento' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Sanchez' rel='stylesheet' type='text/css'>
  <title><%= title %></title>

  </head>
  <body>
    <script>
      $( document ).ready(function() {
        $("#success").hide();
        $("#failure").hide();
        $("#emptyField").hide();

        $("#field").keypress(function(x) {
          var key = x.which;
          if(key == 13) {
            $("#submit").click();
            return false;
          }
        })

        $("#submit").click(function() {
          if($("#field").val() == "") {
            //SUBMITTED EMPTY STRING
            $("#failure").hide();
            $("#emptyField").show();
          }
          else {
            $.ajax({
              type: "POST",
              url: 'shorten',
              data: { payload: $('#field').val() },
            }).done(function(data) {
              console.log(data);
              if(data.error) {
                //BAD URL
                $("#emptyField").hide();
                $("#failure").show();
              }
              else {
                console.log(data);
                //GOOD URL
                var response = JSON.parse(data);
                $("#failure").hide();
                $("#emptyField").hide();
                $("#createShortlink").hide();
                $("#newLink").text(window.location.host + '/' + response.identifier);
                $("#success").show();
              }
            });
          }
        });
      });
    </script>
    <h1 id="header"><%= title %></h1>
    <div id="createShortlink">
      <input type="text" placeholder="Gimme some notes to play, man!" id="field">
      <button class="btn btn-large btn-primary" id="submit">Play that Jazz!</button>
    </div>

    <div id="success">
      <h1 id="newLink">Success</h1>
    </div>

    <div id="failure">
      <h1>Aww come on man. Looks like you gave me a bad URL to play.</h1>
    </div>

    <div id="emptyField">
      <h1>You didn't give me any notes to play.</h1>
    </div>
  </body>
</html>
